## AIPPT的基本原理
1. 定义PPT结构（一套PPT中都有什么类型的页面，每种页面都有些什么内容）；
2. 基于以上结构，定义数据格式，该数据将用于AI生成结构化的PPT数据，具体结构见：
    - 示例数据：`public/mocks/AIPPT.json`
    - 结构定义：`src/types/AIPPT.ts`
3. 制作模板，模板中标记好结构类型；
4. AI生成符合第1步定义的PPT结构的数据；
5. 利用AI或其他方案，生成相关的配图（常见途径有：AI文生图、图库搜索匹配）；
6. 将AI生成的数据、配图与模板进行匹配结合，生成最终的PPT。

> 注：虽然当前线上版本不提供配图演示效果，但是AIPPT的方法是支持此功能的，你只需要自己提供图片源，按照要求的格式将待选图片集合传入AIPPT方法即可。

## AIPPT模板制作流程
1. 打开PPTist；
2. 制作模板页面；
3. 打开左上角菜单[幻灯片类型标注]功能；
4. 为制作好的页面标注页面类型和节点类型；
5. 使用导出功能导出为JSON文件。

> 注意：实际上并不存在专门提供给AIPPT的模板。所谓的AIPPT模板只是把在PPTist中制作的普通页面标注上类型标记而已。这些数据不仅仅用于AI生成PPT，也可以作为普通的页面模板使用。

## 模板标记类型：页面标记和节点标记
#### 封面页
* 标题
* 正文
* 图片（背景图、页面插图）
#### 目录页
* 目录标题（标记类型为：列表项目）
* 图片（背景图、页面插图）
#### 过渡页（章节过渡）
* 标题
* 正文
* 节编号
* 图片（背景图、页面插图）
#### 内容页
* 标题
* 2～4个内容项，包括：
  * 内容项标题（标记类型为：列表项标题）
  * 内容项正文（标记类型为：列表项目）
  * 内容项编号（标记类型为：项目编号）
* 图片（背景图、页面插图、项目插图）
#### 结束页（致谢页）
* 图片（背景图、页面插图）

> 节点标记分为两种 - 文本标记和图片标记：
> - 文本标记可作用于文本节点和带文字的形状节点；
> - 图片标记只作用于图片节点；
> - 你可以自行添加更多类型的标记（如图表）。

## AIPPT模板制作原则
一个用于AIPPT的模板至少包括以下页面（共12页）：
* 1个封面页
* 6个目录页（2～6个目录项各1个，10个目录项的1个）
* 1个过渡页
* 3个内容页（2～4个内容项各1个）
* 1个结束页

> 注意：
> 1. 以上页数仅满足当前替换逻辑的最基本要求，如果希望AI生成的PPT具有一定的随机性，需要适当增加每种页面的数量（举个例子，假设模板中存在3个封面页，生成时会从3个中随机选择1个使用）；
> 2. 当前替换逻辑下，目录页可支持1～20个目录项，内容页可支持1～12个内容项，但不需要每种数量的模板都做一遍，因为程序会自动通过模板的拼接/裁减方式来实现特殊的项目数；
> 3. 你可以自行调整替换逻辑，以支持更多情况。

---

## AIPPT常见问题说明

### 重要说明
**首先说明，PPTist是一个纯前端的Web幻灯片编辑/演示项目，AI生成PPT只是PPTist众多功能中的一个小功能点而已，并不是本项目的核心。**

### 1. AIPPT的后台服务

所谓PPTist的后台其实就两个很简单的大模型服务转发接口：AI主题生成PPT大纲、AI大纲生成PPT内容。可以简单认为：**单纯为了跟风AI，特地搭建了一个后台，这个后台也只有两个简单的AI问答结果转发**。

抛开提示词不算，两个接口实际代码量加起来也就一百来行，它们所做的工作就是：**告诉接入的第三方AI大模型你要干嘛，AI返回结果后原样返回前端，没了，就是这么简单**，只是简单的AI问答结果转发而已，没有其他任何业务逻辑（若有认真查看过代码就会发现，所有的数据处理和模板替换等核心逻辑全部是在前端开源的）。

因此，只要有最基础的web后端开发经验，就能轻松实现。

**总结：没有后端Demo、没有后端参考代码，请自己实现，非常简单，因为核心逻辑已全部在前端开源。**

### 2. 想把AI后台服务改用XXX方式实现可以吗？更换大模型可以吗？该怎么做？

总的来说，如果你需要使用PPTist的AIPPT功能（当然这不是必须的，前面说过这只是PPTist中的一个小功能），就必须花上一点点时间，自己部署一个后台服务，无论是本地部署模型也好，接入AI大模型服务商的API也好，怎么实现不重要，用什么语言框架也不重要，能够让他返回PPTist约定的数据格式即可。

所以回到问题，"想把AI后台服务改用XXX方式实现可以吗？更换大模型可以吗？该怎么做？"，**可以，或者说根本不存在什么"修改"、"更换"，因为后台服务本就是需要自己搭建的，具体怎么实现无所谓，全凭自身喜好，对PPTist来说都是一样的，只管调用接口，返回格式正确就行。**

### 3. 返回要求的格式是什么样的？如何让AI返回要求的格式？

生成流程分为两个步骤：

1. **生成大纲**：markdown格式，数据样例可以在 `/public/mocks/AIPPT_Outline.md` 中查看
2. **生成最终的结构化数据**：JSON格式，数据样例可以在 `/public/mocks/AIPPT.json` 中查看

你需要自己理解这些结构，并告知AI："一个PPT有封面、目录、过渡、内容、结束五种类型的页面，其中，封面页包含一个标题、一个文本，目录页包含一组标题、过渡页包含...等等"，过程中你可以提出你自己的要求，例如主题是什么、语言风格是怎么样、标题大概多少字、目录项数量大概是多少最好...等等，最终加上一个返回示例数据，并让他严格按照示例格式输出即可。

**注意**：2025.02.23 将步骤2改为了流式输出，你需要将接收的JSON stream实时解析出一个个对象，依次返回（每页为一个对象），或直接让AI生成JSONL格式的数据，即每行一个对象。（本质上还是JSON，打开浏览器控制台网络面板就能看到具体格式）

### 4. 我已经实现了接口，怎么使用？我写好的接口报错怎么办？

**怎么使用**：在 `src/services/index.ts` 中，将现在的接口调用方法改成你自己的地址、传参。

**我的接口报错怎么办**：检查你的接口可访问性，这明显不是本仓库能帮你解决的。

### 5. AIPPT的模板从哪里来？

模板是自己制作的，没有银弹。

具体制作方式见本文档前面的章节：[AIPPT模板制作流程](#aippt模板制作流程)

### 6. 生成的PPT样式单一、内容空洞

**样式单一**是因为模板少，预置了几个只是为了满足大家完整体验流程，你可以自己制作补充模板。

**内容空洞**（甚至会出现结构错误）是受限于大模型的能力，现在接入的是免费模型，与主流大模型相比，能力非常弱，有条件的自己更换为可商用级别的大模型即可。其次可以自己扩展生成的工作流，以实现更丰富的输出。（PPTist仓库本身不会去做这些，因为成本很高，个人无法承担）